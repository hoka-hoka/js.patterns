"use strict";

(function ($) {
  let controlCheckbox = $('.mainCheckbox');
  let addBtn = $('.addNewObserver');
  let container = $('.observersContainer');

  class Subject {
    constructor() {
      this.observerList = {};
    }

    addObserver(key, fn) {
      this.observerList[key] = (this.observerList[key] || []).concat(fn);
    }

    offObserver(key, fn) {
      this.observerList[key] = (this.observerList[key] || []).filter(f => f !== fn);
    }

    notify(key, data) {
      (this.observerList[key] || []).forEach(function (fn) {
        fn(data);
      });
    }

  }

  let subject = new Subject();
  subject.addObserver('setCheckbox', ({
    elem,
    value
  }) => setCheckbox({
    elem,
    value
  }));

  function setCheckbox(params) {
    params.elem.get(0).checked = params.value;
  }

  function updateCheckbox() {
    $('.observer').each((i, element) => {
      if (controlCheckbox) {
        subject.notify('setCheckbox', {
          elem: $(element),
          value: controlCheckbox.prop('checked')
        });
      }
    });
  }

  if (controlCheckbox) {
    controlCheckbox.on('click', updateCheckbox);
  }

  if (addBtn) {
    addBtn.on('click', addNewObserver);
  }

  function addNewObserver() {
    var check = $('<input type="checkbox" class="observer">');

    if (container) {
      container.append(check);
    }

    updateCheckbox();
  }
})(jQuery);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3RzL09ic2VydmVyLnBhdHRlcm4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FBR0EsQ0FBQyxVQUFTLENBQVQsRUFBVTtBQUNULE1BQUksZUFBZSxHQUFvQyxDQUFDLENBQUMsZUFBRCxDQUF4RDtBQUNBLE1BQUksTUFBTSxHQUFzQyxDQUFDLENBQUMsaUJBQUQsQ0FBakQ7QUFDQSxNQUFJLFNBQVMsR0FBZ0MsQ0FBQyxDQUFDLHFCQUFELENBQTlDOztBQXFCQSxRQUFNLE9BQU4sQ0FBYTtBQUFiLElBQUEsV0FBQSxHQUFBO0FBQ1MsV0FBQSxZQUFBLEdBRUgsRUFGRztBQWNSOztBQVhDLElBQUEsV0FBVyxDQUF3QixHQUF4QixFQUFnQyxFQUFoQyxFQUF3RDtBQUNqRSxXQUFLLFlBQUwsQ0FBa0IsR0FBbEIsSUFBeUIsQ0FBQyxLQUFLLFlBQUwsQ0FBa0IsR0FBbEIsS0FBMEIsRUFBM0IsRUFBK0IsTUFBL0IsQ0FBc0MsRUFBdEMsQ0FBekI7QUFDRDs7QUFDRCxJQUFBLFdBQVcsQ0FBd0IsR0FBeEIsRUFBZ0MsRUFBaEMsRUFBd0Q7QUFDakUsV0FBSyxZQUFMLENBQWtCLEdBQWxCLElBQXlCLENBQUMsS0FBSyxZQUFMLENBQWtCLEdBQWxCLEtBQTBCLEVBQTNCLEVBQStCLE1BQS9CLENBQXdDLENBQUQsSUFBNkIsQ0FBQyxLQUFLLEVBQTFFLENBQXpCO0FBQ0Q7O0FBQ0QsSUFBQSxNQUFNLENBQXdCLEdBQXhCLEVBQWdDLElBQWhDLEVBQTBDO0FBQzlDLE9BQUMsS0FBSyxZQUFMLENBQWtCLEdBQWxCLEtBQTBCLEVBQTNCLEVBQStCLE9BQS9CLENBQXVDLFVBQVMsRUFBVCxFQUFpQztBQUN0RSxRQUFBLEVBQUUsQ0FBQyxJQUFELENBQUY7QUFDRCxPQUZEO0FBR0Q7O0FBZFU7O0FBaUJiLE1BQUksT0FBTyxHQUFHLElBQUksT0FBSixFQUFkO0FBQ0EsRUFBQSxPQUFPLENBQUMsV0FBUixDQUFvQixhQUFwQixFQUFtQyxDQUFDO0FBQUUsSUFBQSxJQUFGO0FBQVEsSUFBQTtBQUFSLEdBQUQsS0FBcUIsV0FBVyxDQUFDO0FBQUUsSUFBQSxJQUFGO0FBQVEsSUFBQTtBQUFSLEdBQUQsQ0FBbkU7O0FBRUEsV0FBUyxXQUFULENBQXFCLE1BQXJCLEVBQXlDO0FBQ3ZDLElBQUEsTUFBTSxDQUFDLElBQVAsQ0FBWSxHQUFaLENBQWdCLENBQWhCLEVBQW1CLE9BQW5CLEdBQTZCLE1BQU0sQ0FBQyxLQUFwQztBQUNEOztBQUNELFdBQVMsY0FBVCxHQUF1QjtBQUNyQixJQUFBLENBQUMsQ0FBQyxXQUFELENBQUQsQ0FBZSxJQUFmLENBQW9CLENBQUMsQ0FBRCxFQUFJLE9BQUosS0FBZTtBQUNqQyxVQUFLLGVBQUwsRUFBdUI7QUFDckIsUUFBQSxPQUFPLENBQUMsTUFBUixDQUFlLGFBQWYsRUFBOEI7QUFBRSxVQUFBLElBQUksRUFBRSxDQUFDLENBQUMsT0FBRCxDQUFUO0FBQW9CLFVBQUEsS0FBSyxFQUFFLGVBQWUsQ0FBQyxJQUFoQixDQUFxQixTQUFyQjtBQUEzQixTQUE5QjtBQUNEO0FBQ0YsS0FKRDtBQUtEOztBQUVELE1BQUssZUFBTCxFQUF1QjtBQUNyQixJQUFBLGVBQWUsQ0FBQyxFQUFoQixDQUFtQixPQUFuQixFQUE0QixjQUE1QjtBQUNEOztBQUNELE1BQUssTUFBTCxFQUFjO0FBQ1osSUFBQSxNQUFNLENBQUMsRUFBUCxDQUFVLE9BQVYsRUFBbUIsY0FBbkI7QUFDRDs7QUFFRCxXQUFTLGNBQVQsR0FBdUI7QUFDckIsUUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDLDBDQUFELENBQWI7O0FBQ0EsUUFBSyxTQUFMLEVBQWlCO0FBQ2YsTUFBQSxTQUFTLENBQUMsTUFBVixDQUFpQixLQUFqQjtBQUNEOztBQUNELElBQUEsY0FBYztBQUNmO0FBRUYsQ0F0RUQsRUFzRUcsTUF0RUgiLCJzb3VyY2VSb290IjoiIn0=